!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var r=t();for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");r(1),r(2);const n=r(3);AFRAME.registerComponent("google-poly",{schema:{apiKey:{default:""},src:{},normalize:{type:"boolean",default:!0},cache:{type:"boolean",default:!0}},multiple:!1,init:function(){this.model=null},update:function(e){const t=this.el,r=this.data;r.src&&r.apiKey&&(this.remove(),n.getItem(r.src).then(e=>{const n=e;if(r.cache&&null!==e){console.log("using cached",n),(new THREE.GLTFLoader).parse(n,"",e=>{this.processModel(e,!1)})}else this.getGLTFUrl(r.src,r.apiKey).then(this.loadPolyModel).then(e=>{this.processModel(e,!0)}).catch(e=>{console.error('ERROR loading Google Poly model from "'+r.src+'" : '+e),t.emit("model-error",e)})}))},processModel:function(e,t){const r=this.data,a=this.el,o=e.scenes?e.scene||e.scenes[0]:e;if(this.model=o,a.setObject3D("mesh",this.model),r.cache&&t){console.log("caching model",r.src);const e=new THREE.GLTFExporter,t={truncateDrawRange:!1,binary:!1,embedImages:!0,maxTextureSize:4096};new Promise(r=>{e.parse(o,e=>{const t=JSON.stringify(e,null,2);r(t)},t)}).then(e=>{n.setItem(r.src,e).then(e=>{console.log("stored",e)}).catch(e=>{console.log(e)})})}r.normalize&&this.normalize(),a.emit("model-loaded")},normalize:function(){const e=this.el,t=e.getObject3D("mesh"),r=new THREE.Vector3,n=new THREE.Vector3,a=new THREE.Vector3;n.copy(e.object3D.position),a.copy(e.object3D.scale),e.object3D.scale.set(1,1,1),e.object3D.position.set(0,0,0),e.object3D.updateMatrixWorld(!0);const o=new THREE.Box3;o.setFromObject(t);const i=new THREE.Sphere;o.getBoundingSphere(i);const s=i.center,u=i.radius,c=1*(0===u?1:1/u);t.traverse(e=>{e.isMesh&&(e.geometry.scale(c,c,c),e.geometry.translate(-c*s.x+r.x,-c*s.y+r.y,-c*s.z+r.z),e.geometry.computeBoundingBox(),e.geometry.computeBoundingSphere())}),e.object3D.scale.copy(a),e.object3D.position.copy(n),e.object3D.updateMatrixWorld(!0)},_remove:function(){this.model&&this.el.removeObject3D("mesh")},remove:function(){this._remove()},getGLTFUrl:function(e,t){const r="https://poly.googleapis.com/v1/assets/"+e+"/?key="+t;return fetch(r).then(function(t){return t.json().catch(e=>(console.log('ERROR parsing Google Poly API server response JSON.\nRequested Model: "'+r+'"\nError: "'+JSON.stringify(e)+'"'),Promise.reject("Google Poly API server error. Check console for details."))).then(t=>{if(void 0!==t.error)return Promise.reject("Poly API error: "+t.error.message);const r=t.formats.find(e=>"GLTF"===e.formatType||"GLTF2"===e.formatType);if(r){const e=t.presentationParams.orientingRotation,n=new THREE.Quaternion(e.x||0,e.y||0,e.z||0,e.w||1);return{url:r.root.url,quaternion:n,format:r.formatType}}return Promise.reject("Poly asset id:"+e+" not provided in GLTF or GLTF2 format.")})})},loadPolyModel:function(e,t){const r=e.url,n=e.quaternion,a=e.format,o=(new THREE.Matrix4).makeRotationFromQuaternion(n);return new Promise((e,n)=>{const i=new THREE.FileLoader;i.setResponseType("arraybuffer"),i.load(r,t=>{try{const i="GLTF"===a?new THREE.LegacyGLTFLoader:new THREE.GLTFLoader,s=THREE.LoaderUtils.extractUrlBase(r);i.parse(t,s,t=>{t.scene.traverse(function(e){"GLTF"===a&&e.material&&(e.material=new THREE.MeshStandardMaterial({vertexColors:THREE.VertexColors})),e.geometry&&e.geometry.applyMatrix(o)}),e(t)},n)}catch(e){console.error(e),n(e.constructor===Error?e:new Error("THREE.GLTFLoader: Unable to parse model."))}},t,n)})}})},function(e,t){THREE.LegacyGLTFLoader=function(){function e(e){THREE.Loader.call(this,e)}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}},update:function(t,r){for(var n in e){var a=e[n];a.update&&a.update(t,r)}}}}function r(e,t){var r={},n=e.material.uniforms;for(var a in n){var o=n[a];if(o.semantic){var i=o.node,s=e;i&&(s=t[i]),r[a]={semantic:o.semantic,sourceNode:s,targetNode:e,uniform:o}}}this.boundUniforms=r,this._m4=new THREE.Matrix4}e.prototype=Object.assign(Object.create(THREE.Loader.prototype),{constructor:e,load:function(e,t,r,n){var a,o=this;a=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:THREE.LoaderUtils.extractUrlBase(e);var i=new THREE.FileLoader(o.manager);i.setPath(this.path),i.setResponseType("arraybuffer"),i.load(e,function(e){o.parse(e,a,t)},r,n)},parse:function(e,t,r){var i,u={};THREE.LoaderUtils.decodeText(new Uint8Array(e,0,4))===o.magic?(u[n.KHR_BINARY_GLTF]=new s(e),i=u[n.KHR_BINARY_GLTF].content):i=THREE.LoaderUtils.decodeText(new Uint8Array(e));var c=JSON.parse(i);c.extensionsUsed&&c.extensionsUsed.indexOf(n.KHR_MATERIALS_COMMON)>=0&&(u[n.KHR_MATERIALS_COMMON]=new a(c)),new S(c,u,{crossOrigin:this.crossOrigin,manager:this.manager,path:t||this.resourcePath||""}).parse(function(e,t,n,a){r({scene:e,scenes:t,cameras:n,animations:a})})}}),e.Shaders={update:function(){console.warn("THREE.LegacyGLTFLoader.Shaders has been deprecated, and now updates automatically.")}},r.prototype.update=function(e,t){var r=this.boundUniforms;for(var n in r){var a=r[n];switch(a.semantic){case"MODELVIEW":a.uniform.value.multiplyMatrices(t.matrixWorldInverse,a.sourceNode.matrixWorld);break;case"MODELVIEWINVERSETRANSPOSE":var o=a.uniform.value;this._m4.multiplyMatrices(t.matrixWorldInverse,a.sourceNode.matrixWorld),o.getNormalMatrix(this._m4);break;case"PROJECTION":a.uniform.value.copy(t.projectionMatrix);break;case"JOINTMATRIX":for(var i=a.uniform.value,s=0;s<i.length;s++)i[s].getInverse(a.sourceNode.matrixWorld).multiply(a.targetNode.skeleton.bones[s].matrixWorld).multiply(a.targetNode.skeleton.boneInverses[s]).multiply(a.targetNode.bindMatrix);break;default:console.warn("Unhandled shader semantic: "+a.semantic)}}},e.Animations={update:function(){console.warn("THREE.LegacyGLTFLoader.Animation has been deprecated. Use THREE.AnimationMixer instead.")}};var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_MATERIALS_COMMON:"KHR_materials_common"};function a(e){this.name=n.KHR_MATERIALS_COMMON,this.lights={};var t=(e.extensions&&e.extensions[n.KHR_MATERIALS_COMMON]||{}).lights||{};for(var r in t){var a,o=t[r],i=o[o.type],s=(new THREE.Color).fromArray(i.color);switch(o.type){case"directional":(a=new THREE.DirectionalLight(s)).position.set(0,0,1);break;case"point":a=new THREE.PointLight(s);break;case"spot":(a=new THREE.SpotLight(s)).position.set(0,0,1);break;case"ambient":a=new THREE.AmbientLight(s)}a&&(this.lights[r]=a)}}var o={magic:"glTF",version:1,contentFormat:0},i=20;function s(e){this.name=n.KHR_BINARY_GLTF;var t=new DataView(e,0,i),r={magic:THREE.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0),contentLength:t.getUint32(12,!0),contentFormat:t.getUint32(16,!0)};for(var a in o){var s=o[a];if(r[a]!==s)throw new Error('Unsupported glTF-Binary header: Expected "%s" to be "%s".',a,s)}var u=new Uint8Array(e,i,r.contentLength);this.header=r,this.content=THREE.LoaderUtils.decodeText(u),this.body=e.slice(i+r.contentLength,r.length)}s.prototype.loadShader=function(e,t){var r=t[e.extensions[n.KHR_BINARY_GLTF].bufferView],a=new Uint8Array(r);return THREE.LoaderUtils.decodeText(a)};var u={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,TRIANGLES:4,LINES:1,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,VERTEX_SHADER:35633,FRAGMENT_SHADER:35632},c={5126:Number,35675:THREE.Matrix3,35676:THREE.Matrix4,35664:THREE.Vector2,35665:THREE.Vector3,35666:THREE.Vector4,35678:THREE.Texture},l={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},f={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},d={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},h={6406:THREE.AlphaFormat,6407:THREE.RGBFormat,6408:THREE.RGBAFormat,6409:THREE.LuminanceFormat,6410:THREE.LuminanceAlphaFormat},p={5121:THREE.UnsignedByteType,32819:THREE.UnsignedShort4444Type,32820:THREE.UnsignedShort5551Type,33635:THREE.UnsignedShort565Type},m={1028:THREE.BackSide,1029:THREE.FrontSide},v={512:THREE.NeverDepth,513:THREE.LessDepth,514:THREE.EqualDepth,515:THREE.LessEqualDepth,516:THREE.GreaterEqualDepth,517:THREE.NotEqualDepth,518:THREE.GreaterEqualDepth,519:THREE.AlwaysDepth},E={32774:THREE.AddEquation,32778:THREE.SubtractEquation,32779:THREE.ReverseSubtractEquation},g={0:THREE.ZeroFactor,1:THREE.OneFactor,768:THREE.SrcColorFactor,769:THREE.OneMinusSrcColorFactor,770:THREE.SrcAlphaFactor,771:THREE.OneMinusSrcAlphaFactor,772:THREE.DstAlphaFactor,773:THREE.OneMinusDstAlphaFactor,774:THREE.DstColorFactor,775:THREE.OneMinusDstColorFactor,776:THREE.SrcAlphaSaturateFactor},y={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},b={scale:"scale",translation:"position",rotation:"quaternion"},T={LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},R={2884:"CULL_FACE",2929:"DEPTH_TEST",3042:"BLEND",3089:"SCISSOR_TEST",32823:"POLYGON_OFFSET_FILL",32926:"SAMPLE_ALPHA_TO_COVERAGE"};function w(e,t,r){if(!e)return Promise.resolve();var n,a=[];if("[object Array]"===Object.prototype.toString.call(e)){n=[];for(var o=e.length,i=0;i<o;i++){(u=t.call(r||this,e[i],i))&&(a.push(u),u instanceof Promise?u.then(function(e,t){n[e]=t}.bind(this,i)):n[i]=u)}}else for(var s in n={},e){var u;if(e.hasOwnProperty(s))(u=t.call(r||this,e[s],s))&&(a.push(u),u instanceof Promise?u.then(function(e,t){n[e]=t}.bind(this,s)):n[s]=u)}return Promise.all(a).then(function(){return n})}function _(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:(t||"")+e}function A(e){this.isDeferredShaderMaterial=!0,this.params=e}function S(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t}return A.prototype.create=function(){var e=THREE.UniformsUtils.clone(this.params.uniforms);for(var t in this.params.uniforms){var r=this.params.uniforms[t];r.value instanceof THREE.Texture&&(e[t].value=r.value,e[t].value.needsUpdate=!0),e[t].semantic=r.semantic,e[t].node=r.node}return this.params.uniforms=e,new THREE.RawShaderMaterial(this.params)},S.prototype._withDependencies=function(e){for(var t={},r=0;r<e.length;r++){var n=e[r],a="load"+n.charAt(0).toUpperCase()+n.slice(1),o=this.cache.get(n);if(void 0!==o)t[n]=o;else if(this[a]){var i=this[a]();this.cache.add(n,i),t[n]=i}}return w(t,function(e){return e})},S.prototype.parse=function(e){var t=this.json;this.cache.removeAll(),this._withDependencies(["scenes","cameras","animations"]).then(function(r){var n=[];for(var a in r.scenes)n.push(r.scenes[a]);var o=void 0!==t.scene?r.scenes[t.scene]:n[0],i=[];for(var a in r.cameras){var s=r.cameras[a];i.push(s)}var u=[];for(var a in r.animations)u.push(r.animations[a]);e(o,n,i,u)})},S.prototype.loadShaders=function(){var e=this.json,t=this.extensions,r=this.options;return this._withDependencies(["bufferViews"]).then(function(a){return w(e.shaders,function(e){return e.extensions&&e.extensions[n.KHR_BINARY_GLTF]?t[n.KHR_BINARY_GLTF].loadShader(e,a.bufferViews):new Promise(function(t){var n=new THREE.FileLoader(r.manager);n.setResponseType("text"),n.load(_(e.uri,r.path),function(e){t(e)})})})})},S.prototype.loadBuffers=function(){var e=this.json,t=this.extensions,r=this.options;return w(e.buffers,function(e,a){return"binary_glTF"===a?t[n.KHR_BINARY_GLTF].body:"arraybuffer"===e.type||void 0===e.type?new Promise(function(t){var n=new THREE.FileLoader(r.manager);n.setResponseType("arraybuffer"),n.load(_(e.uri,r.path),function(e){t(e)})}):void console.warn("THREE.LegacyGLTFLoader: "+e.type+" buffer type is not supported")})},S.prototype.loadBufferViews=function(){var e=this.json;return this._withDependencies(["buffers"]).then(function(t){return w(e.bufferViews,function(e){var r=t.buffers[e.buffer],n=void 0!==e.byteLength?e.byteLength:0;return r.slice(e.byteOffset,e.byteOffset+n)})})},S.prototype.loadAccessors=function(){var e=this.json;return this._withDependencies(["bufferViews"]).then(function(t){return w(e.accessors,function(e){var r=t.bufferViews[e.bufferView],n=y[e.type],a=l[e.componentType],o=a.BYTES_PER_ELEMENT,i=o*n;if(e.byteStride&&e.byteStride!==i){var s=new a(r),u=new THREE.InterleavedBuffer(s,e.byteStride/o);return new THREE.InterleavedBufferAttribute(u,n,e.byteOffset/o)}return s=new a(r,e.byteOffset,e.count*n),new THREE.BufferAttribute(s,n)})})},S.prototype.loadTextures=function(){var e=this.json,t=this.options;return this._withDependencies(["bufferViews"]).then(function(r){return w(e.textures,function(a){if(a.source)return new Promise(function(o){var i=e.images[a.source],s=i.uri,u=!1;if(i.extensions&&i.extensions[n.KHR_BINARY_GLTF]){var c=i.extensions[n.KHR_BINARY_GLTF],l=r.bufferViews[c.bufferView],m=new Blob([l],{type:c.mimeType});s=URL.createObjectURL(m),u=!0}var v=t.manager.getHandler(s);null===v&&(v=new THREE.TextureLoader(t.manager)),v.setCrossOrigin(t.crossOrigin),v.load(_(s,t.path),function(t){if(u&&URL.revokeObjectURL(s),t.flipY=!1,void 0!==a.name&&(t.name=a.name),t.format=void 0!==a.format?h[a.format]:THREE.RGBAFormat,void 0!==a.internalFormat&&t.format!==h[a.internalFormat]&&console.warn("THREE.LegacyGLTFLoader: Three.js doesn't support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),t.type=void 0!==a.type?p[a.type]:THREE.UnsignedByteType,a.sampler){var r=e.samplers[a.sampler];t.magFilter=f[r.magFilter]||THREE.LinearFilter,t.minFilter=f[r.minFilter]||THREE.NearestMipmapLinearFilter,t.wrapS=d[r.wrapS]||THREE.RepeatWrapping,t.wrapT=d[r.wrapT]||THREE.RepeatWrapping}o(t)},void 0,function(){u&&URL.revokeObjectURL(s),o()})})})})},S.prototype.loadMaterials=function(){var e=this.json;return this._withDependencies(["shaders","textures"]).then(function(t){return w(e.materials,function(r){var a,o,i={},s={};if(r.extensions&&r.extensions[n.KHR_MATERIALS_COMMON]&&(o=r.extensions[n.KHR_MATERIALS_COMMON]),o){var l=["ambient","emission","transparent","transparency","doubleSided"];switch(o.technique){case"BLINN":case"PHONG":a=THREE.MeshPhongMaterial,l.push("diffuse","specular","shininess");break;case"LAMBERT":a=THREE.MeshLambertMaterial,l.push("diffuse");break;case"CONSTANT":default:a=THREE.MeshBasicMaterial}l.forEach(function(e){void 0!==o.values[e]&&(i[e]=o.values[e])}),(o.doubleSided||i.doubleSided)&&(s.side=THREE.DoubleSide),(o.transparent||i.transparent)&&(s.transparent=!0,s.opacity=void 0!==i.transparency?i.transparency:1)}else if(void 0===r.technique)a=THREE.MeshPhongMaterial,Object.assign(i,r.values);else{a=A;var f=e.techniques[r.technique];s.uniforms={};var d=e.programs[f.program];if(d){s.fragmentShader=t.shaders[d.fragmentShader],s.fragmentShader||(console.warn("ERROR: Missing fragment shader definition:",d.fragmentShader),a=THREE.MeshPhongMaterial);var h=t.shaders[d.vertexShader];h||(console.warn("ERROR: Missing vertex shader definition:",d.vertexShader),a=THREE.MeshPhongMaterial),s.vertexShader=function(e,t){var r={};for(var n in t.attributes){var a=t.attributes[n],o=(f=t.parameters[a]).type,i=f.semantic;r[n]={type:o,semantic:i}}var s=t.parameters,u=t.attributes,c={};for(var n in r){var l=s[a=u[n]];(i=l.semantic)&&(c[n]=l)}for(var a in c){i=(f=c[a]).semantic;var f,d=new RegExp("\\b"+a+"\\b","g");switch(i){case"POSITION":e=e.replace(d,"position");break;case"NORMAL":e=e.replace(d,"normal");break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":e=e.replace(d,"uv");break;case"TEXCOORD_1":e=e.replace(d,"uv2");break;case"COLOR_0":case"COLOR0":case"COLOR":e=e.replace(d,"color");break;case"WEIGHT":e=e.replace(d,"skinWeight");break;case"JOINT":e=e.replace(d,"skinIndex")}}return e}(h,f);var p=f.uniforms;for(var y in p){var b=p[y],T=f.parameters[b],w=T.type;if(!c[w])throw new Error("Unknown shader uniform param type: "+w);var _,S=T.count;void 0!==r.values&&(_=r.values[b]);var I=new c[w],L=T.semantic,x=T.node;switch(w){case u.FLOAT:I=T.value,"transparency"==b&&(s.transparent=!0),void 0!==_&&(I=_);break;case u.FLOAT_VEC2:case u.FLOAT_VEC3:case u.FLOAT_VEC4:case u.FLOAT_MAT3:T&&T.value&&I.fromArray(T.value),_&&I.fromArray(_);break;case u.FLOAT_MAT2:console.warn("FLOAT_MAT2 is not a supported uniform type");break;case u.FLOAT_MAT4:if(S){I=new Array(S);for(var M=0;M<S;M++)I[M]=new c[w];if(T&&T.value){var N=T.value;I.fromArray(N)}_&&I.fromArray(_)}else{if(T&&T.value){var H=T.value;I.fromArray(H)}_&&I.fromArray(_)}break;case u.SAMPLER_2D:I=void 0!==_?t.textures[_]:void 0!==T.value?t.textures[T.value]:null}s.uniforms[y]={value:I,semantic:L,node:x}}for(var O=f.states||{},F=O.enable||[],D=O.functions||{},C=!1,B=!1,j=!1,k=0,G=F.length;k<G;k++){var P=F[k];switch(R[P]){case"CULL_FACE":C=!0;break;case"DEPTH_TEST":B=!0;break;case"BLEND":j=!0;break;case"SCISSOR_TEST":case"POLYGON_OFFSET_FILL":case"SAMPLE_ALPHA_TO_COVERAGE":break;default:throw new Error("Unknown technique.states.enable: "+P)}}s.side=C?void 0!==D.cullFace?m[D.cullFace]:THREE.FrontSide:THREE.DoubleSide,s.depthTest=B,s.depthFunc=void 0!==D.depthFunc?v[D.depthFunc]:THREE.LessDepth,s.depthWrite=void 0===D.depthMask||D.depthMask[0],s.blending=j?THREE.CustomBlending:THREE.NoBlending,s.transparent=j;var U=D.blendEquationSeparate;void 0!==U?(s.blendEquation=E[U[0]],s.blendEquationAlpha=E[U[1]]):(s.blendEquation=THREE.AddEquation,s.blendEquationAlpha=THREE.AddEquation);var z=D.blendFuncSeparate;void 0!==z?(s.blendSrc=g[z[0]],s.blendDst=g[z[1]],s.blendSrcAlpha=g[z[2]],s.blendDstAlpha=g[z[3]]):(s.blendSrc=THREE.OneFactor,s.blendDst=THREE.ZeroFactor,s.blendSrcAlpha=THREE.OneFactor,s.blendDstAlpha=THREE.ZeroFactor)}}Array.isArray(i.diffuse)?s.color=(new THREE.Color).fromArray(i.diffuse):"string"==typeof i.diffuse&&(s.map=t.textures[i.diffuse]),delete s.diffuse,"string"==typeof i.reflective&&(s.envMap=t.textures[i.reflective]),"string"==typeof i.bump&&(s.bumpMap=t.textures[i.bump]),Array.isArray(i.emission)?a===THREE.MeshBasicMaterial?s.color=(new THREE.Color).fromArray(i.emission):s.emissive=(new THREE.Color).fromArray(i.emission):"string"==typeof i.emission&&(a===THREE.MeshBasicMaterial?s.map=t.textures[i.emission]:s.emissiveMap=t.textures[i.emission]),Array.isArray(i.specular)?s.specular=(new THREE.Color).fromArray(i.specular):"string"==typeof i.specular&&(s.specularMap=t.textures[i.specular]),void 0!==i.shininess&&(s.shininess=i.shininess);var V=new a(s);return void 0!==r.name&&(V.name=r.name),V})})},S.prototype.loadMeshes=function(){var e=this.json;return this._withDependencies(["accessors","materials"]).then(function(t){return w(e.meshes,function(r){var n=new THREE.Group;void 0!==r.name&&(n.name=r.name),r.extras&&(n.userData=r.extras);var a=r.primitives||[];for(var o in a){var i=a[o];if(i.mode===u.TRIANGLES||void 0===i.mode){var s=new THREE.BufferGeometry,c=i.attributes;for(var l in c){if(!(m=c[l]))return;var f=t.accessors[m];switch(l){case"POSITION":s.setAttribute("position",f);break;case"NORMAL":s.setAttribute("normal",f);break;case"TEXCOORD_0":case"TEXCOORD0":case"TEXCOORD":s.setAttribute("uv",f);break;case"TEXCOORD_1":s.setAttribute("uv2",f);break;case"COLOR_0":case"COLOR0":case"COLOR":s.setAttribute("color",f);break;case"WEIGHT":s.setAttribute("skinWeight",f);break;case"JOINT":s.setAttribute("skinIndex",f);break;default:if(!i.material)break;if(!(p=e.materials[i.material]).technique)break;var d=e.techniques[p.technique].parameters||{};for(var h in d)d[h].semantic===l&&s.setAttribute(h,f)}}i.indices&&s.setIndex(t.accessors[i.indices]);var p=void 0!==t.materials?t.materials[i.material]:new THREE.MeshPhongMaterial({color:0,emissive:8947848,specular:0,shininess:0,transparent:!1,depthTest:!0,side:THREE.FrontSide});(v=new THREE.Mesh(s,p)).castShadow=!0,v.name="0"===o?n.name:n.name+o,i.extras&&(v.userData=i.extras),n.add(v)}else if(i.mode===u.LINES){s=new THREE.BufferGeometry,c=i.attributes;for(var l in c){var m;if(!(m=c[l]))return;f=t.accessors[m];switch(l){case"POSITION":s.setAttribute("position",f);break;case"COLOR_0":case"COLOR0":case"COLOR":s.setAttribute("color",f)}}var v;p=t.materials[i.material];i.indices?(s.setIndex(t.accessors[i.indices]),v=new THREE.LineSegments(s,p)):v=new THREE.Line(s,p),v.name="0"===o?n.name:n.name+o,i.extras&&(v.userData=i.extras),n.add(v)}else console.warn("Only triangular and line primitives are supported")}return n})})},S.prototype.loadCameras=function(){return w(this.json.cameras,function(e){if("perspective"==e.type&&e.perspective){var t=e.perspective.yfov,r=void 0!==e.perspective.aspectRatio?e.perspective.aspectRatio:1,n=t*r,a=new THREE.PerspectiveCamera(THREE.Math.radToDeg(n),r,e.perspective.znear||1,e.perspective.zfar||2e6);return void 0!==e.name&&(a.name=e.name),e.extras&&(a.userData=e.extras),a}if("orthographic"==e.type&&e.orthographic){a=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,e.orthographic.znear,e.orthographic.zfar);return void 0!==e.name&&(a.name=e.name),e.extras&&(a.userData=e.extras),a}})},S.prototype.loadSkins=function(){var e=this.json;return this._withDependencies(["accessors"]).then(function(t){return w(e.skins,function(e){var r=new THREE.Matrix4;return void 0!==e.bindShapeMatrix&&r.fromArray(e.bindShapeMatrix),{bindShapeMatrix:r,jointNames:e.jointNames,inverseBindMatrices:t.accessors[e.inverseBindMatrices]}})})},S.prototype.loadAnimations=function(){var e=this.json;return this._withDependencies(["accessors","nodes"]).then(function(t){return w(e.animations,function(e,r){var n=[];for(var a in e.channels){var o=e.channels[a],i=e.samplers[o.sampler];if(i){var s=o.target,u=s.id,c=void 0!==e.parameters?e.parameters[i.input]:i.input,l=void 0!==e.parameters?e.parameters[i.output]:i.output,f=t.accessors[c],d=t.accessors[l],h=t.nodes[u];if(h){h.updateMatrix(),h.matrixAutoUpdate=!0;var p=b[s.path]===b.rotation?THREE.QuaternionKeyframeTrack:THREE.VectorKeyframeTrack,m=h.name?h.name:h.uuid,v=void 0!==i.interpolation?T[i.interpolation]:THREE.InterpolateLinear;n.push(new p(m+"."+b[s.path],THREE.AnimationUtils.arraySlice(f.array,0),THREE.AnimationUtils.arraySlice(d.array,0),v))}}}u=void 0!==e.name?e.name:"animation_"+r;return new THREE.AnimationClip(u,void 0,n)})})},S.prototype.loadNodes=function(){var e=this.json,t=this.extensions,r=this;return w(e.nodes,function(e){var t,r=new THREE.Matrix4;return e.jointName?((t=new THREE.Bone).name=void 0!==e.name?e.name:e.jointName,t.jointName=e.jointName):(t=new THREE.Object3D,void 0!==e.name&&(t.name=e.name)),e.extras&&(t.userData=e.extras),void 0!==e.matrix?(r.fromArray(e.matrix),t.applyMatrix(r)):(void 0!==e.translation&&t.position.fromArray(e.translation),void 0!==e.rotation&&t.quaternion.fromArray(e.rotation),void 0!==e.scale&&t.scale.fromArray(e.scale)),t}).then(function(a){return r._withDependencies(["meshes","skins","cameras"]).then(function(r){return w(a,function(o,i){var s=e.nodes[i];if(void 0!==s.meshes)for(var u in s.meshes){var c=s.meshes[u],l=r.meshes[c];if(void 0!==l)for(var f in l.children){var d,h=l.children[f],p=h.material,m=h.geometry,v=h.userData,E=h.name;switch(p.isDeferredShaderMaterial?p=g=p.create():g=p,h.type){case"LineSegments":h=new THREE.LineSegments(m,g);break;case"LineLoop":h=new THREE.LineLoop(m,g);break;case"Line":h=new THREE.Line(m,g);break;default:h=new THREE.Mesh(m,g)}if(h.castShadow=!0,h.userData=v,h.name=E,s.skin&&(d=r.skins[s.skin]),d){var g,y=function(e){for(var t=Object.keys(a),r=0,n=t.length;r<n;r++){var o=a[t[r]];if(o.jointName===e)return o}return null},b=m;(g=p).skinning=!0,(h=new THREE.SkinnedMesh(b,g)).castShadow=!0,h.userData=v,h.name=E;for(var T=[],R=[],w=0,_=d.jointNames.length;w<_;w++){var A=d.jointNames[w],S=y(A);if(S){T.push(S);var I=d.inverseBindMatrices.array,L=(new THREE.Matrix4).fromArray(I,16*w);R.push(L)}else console.warn("WARNING: joint: '"+A+"' could not be found")}h.bind(new THREE.Skeleton(T,R),d.bindShapeMatrix);var x=function(t,r,n){var o=t[n];if(void 0!==o)for(var i=0,s=o.length;i<s;i++){var u=o[i],c=a[u],l=e.nodes[u];void 0!==c&&!0===c.isBone&&void 0!==l&&(r.add(c),x(l,c,"children"))}};x(s,h,"skeletons")}o.add(h)}else console.warn("LegacyGLTFLoader: Couldn't find node \""+c+'".')}if(void 0!==s.camera){var M=r.cameras[s.camera];o.add(M)}if(s.extensions&&s.extensions[n.KHR_MATERIALS_COMMON]&&s.extensions[n.KHR_MATERIALS_COMMON].light){var N=t[n.KHR_MATERIALS_COMMON].lights[s.extensions[n.KHR_MATERIALS_COMMON].light];o.add(N)}return o})})})},S.prototype.loadScenes=function(){var e=this.json;function t(r,n,a){var o=a[r];n.add(o);var i=e.nodes[r];if(i.children)for(var s=i.children,u=0,c=s.length;u<c;u++){t(s[u],o,a)}}return this._withDependencies(["nodes"]).then(function(n){return w(e.scenes,function(e){var a=new THREE.Scene;void 0!==e.name&&(a.name=e.name),e.extras&&(a.userData=e.extras);for(var o=e.nodes||[],i=0,s=o.length;i<s;i++){t(o[i],a,n.nodes)}return a.traverse(function(e){e.material&&e.material.isRawShaderMaterial&&(e.gltfShader=new r(e,n.nodes),e.onBeforeRender=function(e,t,r){this.gltfShader.update(t,r)})}),a})})},e}()},function(e,t){var r={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},n=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],a={};a[THREE.NearestFilter]=r.NEAREST,a[THREE.NearestMipmapNearestFilter]=r.NEAREST_MIPMAP_NEAREST,a[THREE.NearestMipmapLinearFilter]=r.NEAREST_MIPMAP_LINEAR,a[THREE.LinearFilter]=r.LINEAR,a[THREE.LinearMipmapNearestFilter]=r.LINEAR_MIPMAP_NEAREST,a[THREE.LinearMipmapLinearFilter]=r.LINEAR_MIPMAP_LINEAR,a[THREE.ClampToEdgeWrapping]=r.CLAMP_TO_EDGE,a[THREE.RepeatWrapping]=r.REPEAT,a[THREE.MirroredRepeatWrapping]=r.MIRRORED_REPEAT;var o={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};THREE.GLTFExporter=function(){},THREE.GLTFExporter.prototype={constructor:THREE.GLTFExporter,parse:function(e,t,i){var s={binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1};(i=Object.assign({},s,i)).animations.length>0&&(i.trs=!0);var u,c={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},l=0,f=[],d=[],h=new Map,p=[],m={},v={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},E=new Map,g=0;function y(e){return E.has(e)||E.set(e,g++),E.get(e)}function b(e,t){return e.length===t.length&&e.every(function(e,r){return e===t[r]})}function T(e){return 4*Math.ceil(e/4)}function R(e,t){t=t||0;var r=T(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var a=e.byteLength;a<r;a++)n[a]=t;return n.buffer}return e}function w(e,t){if(0!==Object.keys(e.userData).length)try{var r=JSON.parse(JSON.stringify(e.userData));if(i.includeCustomExtensions&&r.gltfExtensions){for(var n in void 0===t.extensions&&(t.extensions={}),r.gltfExtensions)t.extensions[n]=r.gltfExtensions[n],m[n]=!0;delete r.gltfExtensions}Object.keys(r).length>0&&(t.extras=r)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}function _(e,t){var r=!1,n={};0===t.offset.x&&0===t.offset.y||(n.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(n.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(n.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=n,m.KHR_texture_transform=!0)}function A(e){return c.buffers||(c.buffers=[{byteLength:0}]),f.push(e),0}function S(e,t,n,a){var o;if(e.array.constructor===Float32Array)o=r.FLOAT;else if(e.array.constructor===Uint32Array)o=r.UNSIGNED_INT;else if(e.array.constructor===Uint16Array)o=r.UNSIGNED_SHORT;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");o=r.UNSIGNED_BYTE}if(void 0===n&&(n=0),void 0===a&&(a=e.count),i.truncateDrawRange&&void 0!==t&&null===t.index){var s=n+a,u=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;n=Math.max(n,t.drawRange.start),(a=Math.min(s,u)-n)<0&&(a=0)}if(0===a)return null;var f,d=function(e,t,r){for(var n={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},a=t;a<t+r;a++)for(var o=0;o<e.itemSize;o++){var i;e.itemSize>4?i=e.array[a*e.itemSize+o]:0===o?i=e.getX(a):1===o?i=e.getY(a):2===o?i=e.getZ(a):3===o&&(i=e.getW(a)),n.min[o]=Math.min(n.min[o],i),n.max[o]=Math.max(n.max[o],i)}return n}(e,n,a);void 0!==t&&(f=e===t.index?r.ELEMENT_ARRAY_BUFFER:r.ARRAY_BUFFER);var h=function(e,t,n,a,o){var i;c.bufferViews||(c.bufferViews=[]),i=t===r.UNSIGNED_BYTE?1:t===r.UNSIGNED_SHORT?2:4;for(var s=T(a*e.itemSize*i),u=new DataView(new ArrayBuffer(s)),f=0,d=n;d<n+a;d++)for(var h=0;h<e.itemSize;h++){var p;e.itemSize>4?p=e.array[d*e.itemSize+h]:0===h?p=e.getX(d):1===h?p=e.getY(d):2===h?p=e.getZ(d):3===h&&(p=e.getW(d)),t===r.FLOAT?u.setFloat32(f,p,!0):t===r.UNSIGNED_INT?u.setUint32(f,p,!0):t===r.UNSIGNED_SHORT?u.setUint16(f,p,!0):t===r.UNSIGNED_BYTE&&u.setUint8(f,p),f+=i}var m={buffer:A(u.buffer),byteOffset:l,byteLength:s};return void 0!==o&&(m.target=o),o===r.ARRAY_BUFFER&&(m.byteStride=e.itemSize*i),l+=s,c.bufferViews.push(m),{id:c.bufferViews.length-1,byteLength:0}}(e,o,n,a,f),p={bufferView:h.id,byteOffset:h.byteOffset,componentType:o,count:a,max:d.max,min:d.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};return!0===e.normalized&&(p.normalized=!0),c.accessors||(c.accessors=[]),c.accessors.push(p),c.accessors.length-1}function I(e,t,r){v.images.has(e)||v.images.set(e,{});var n=v.images.get(e),a=t===THREE.RGBAFormat?"image/png":"image/jpeg",o=a+":flipY/"+r.toString();if(void 0!==n[o])return n[o];c.images||(c.images=[]);var s={mimeType:a};if(i.embedImages){var f=u=u||document.createElement("canvas");f.width=Math.min(e.width,i.maxTextureSize),f.height=Math.min(e.height,i.maxTextureSize);var h=f.getContext("2d");if(!0===r&&(h.translate(0,f.height),h.scale(1,-1)),"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)h.drawImage(e,0,0,f.width,f.height);else{t!==THREE.RGBAFormat&&t!==THREE.RGBFormat&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(e.width>i.maxTextureSize||e.height>i.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);let r=e.data;if(t===THREE.RGBFormat){r=new Uint8ClampedArray(e.height*e.width*4);for(var p=0,m=0;p<r.length;p+=4,m+=3)r[p+0]=e.data[m+0],r[p+1]=e.data[m+1],r[p+2]=e.data[m+2],r[p+3]=255}h.putImageData(new ImageData(r,e.width,e.height),0,0)}!0===i.binary?d.push(new Promise(function(e){f.toBlob(function(t){(function(e){return c.bufferViews||(c.bufferViews=[]),new Promise(function(t){var r=new window.FileReader;r.readAsArrayBuffer(e),r.onloadend=function(){var e=R(r.result),n={buffer:A(e),byteOffset:l,byteLength:e.byteLength};l+=e.byteLength,c.bufferViews.push(n),t(c.bufferViews.length-1)}})})(t).then(function(t){s.bufferView=t,e()})},a)})):s.uri=f.toDataURL(a)}else s.uri=e.src;c.images.push(s);var E=c.images.length-1;return n[o]=E,E}function L(e){c.samplers||(c.samplers=[]);var t={magFilter:a[e.magFilter],minFilter:a[e.minFilter],wrapS:a[e.wrapS],wrapT:a[e.wrapT]};return c.samplers.push(t),c.samplers.length-1}function x(e){if(v.textures.has(e))return v.textures.get(e);c.textures||(c.textures=[]);var t={sampler:L(e),source:I(e.image,e.format,e.flipY)};e.name&&(t.name=e.name),c.textures.push(t);var r=c.textures.length-1;return v.textures.set(e,r),r}function M(e){if(v.materials.has(e))return v.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;c.materials||(c.materials=[]);var t={pbrMetallicRoughness:{}};e.isMeshBasicMaterial?(t.extensions={KHR_materials_unlit:{}},m.KHR_materials_unlit=!0):e.isGLTFSpecularGlossinessMaterial?(t.extensions={KHR_materials_pbrSpecularGlossiness:{}},m.KHR_materials_pbrSpecularGlossiness=!0):e.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var r=e.color.toArray().concat([e.opacity]);if(b(r,[1,1,1,1])||(t.pbrMetallicRoughness.baseColorFactor=r),e.isMeshStandardMaterial?(t.pbrMetallicRoughness.metallicFactor=e.metalness,t.pbrMetallicRoughness.roughnessFactor=e.roughness):e.isMeshBasicMaterial?(t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9):(t.pbrMetallicRoughness.metallicFactor=.5,t.pbrMetallicRoughness.roughnessFactor=.5),e.isGLTFSpecularGlossinessMaterial){t.pbrMetallicRoughness.baseColorFactor&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var n=[1,1,1];e.specular.toArray(n,0),t.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=n,t.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=e.glossiness}if(e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var a={index:x(e.metalnessMap)};_(a,e.metalnessMap),t.pbrMetallicRoughness.metallicRoughnessTexture=a}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var o={index:x(e.map)};_(o,e.map),e.isGLTFSpecularGlossinessMaterial&&(t.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=o),t.pbrMetallicRoughness.baseColorTexture=o}if(e.isGLTFSpecularGlossinessMaterial&&e.specularMap){var i={index:x(e.specularMap)};_(i,e.specularMap),t.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=i}if(e.emissive){var s=e.emissive.clone().multiplyScalar(e.emissiveIntensity).toArray();if(b(s,[0,0,0])||(t.emissiveFactor=s),e.emissiveMap){var u={index:x(e.emissiveMap)};_(u,e.emissiveMap),t.emissiveTexture=u}}if(e.normalMap){var l={index:x(e.normalMap)};e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),l.scale=e.normalScale.x),_(l,e.normalMap),t.normalTexture=l}if(e.aoMap){var f={index:x(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(f.strength=e.aoMapIntensity),_(f,e.aoMap),t.occlusionTexture=f}e.transparent?t.alphaMode="BLEND":e.alphaTest>0&&(t.alphaMode="MASK",t.alphaCutoff=e.alphaTest),e.side===THREE.DoubleSide&&(t.doubleSided=!0),""!==e.name&&(t.name=e.name),w(e,t),c.materials.push(t);var d=c.materials.length-1;return v.materials.set(e,d),d}function N(e){var t=[e.geometry.uuid];if(Array.isArray(e.material))for(var n=0,a=e.material.length;n<a;n++)t.push(e.material[n].uuid);else t.push(e.material.uuid);var o=t.join(":");if(v.meshes.has(o))return v.meshes.get(o);var i,s=e.geometry;i=e.isLineSegments?r.LINES:e.isLineLoop?r.LINE_LOOP:e.isLine?r.LINE_STRIP:e.isPoints?r.POINTS:e.material.wireframe?r.LINES:r.TRIANGLES,s.isBufferGeometry||(console.warn("GLTFExporter: Exporting THREE.Geometry will increase file size. Use THREE.BufferGeometry instead."),s=(new THREE.BufferGeometry).setFromObject(e));var u={},l={},f=[],d=[],h={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},p=s.getAttribute("normal");void 0===p||function(e){if(v.attributesNormalized.has(e))return!1;for(var t=new THREE.Vector3,r=0,n=e.count;r<n;r++)if(Math.abs(t.fromBufferAttribute(e,r).length()-1)>5e-4)return!1;return!0}(p)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),s.setAttribute("normal",function(e){if(v.attributesNormalized.has(e))return v.attributesNormalized.get(e);for(var t=e.clone(),r=new THREE.Vector3,n=0,a=t.count;n<a;n++)r.fromBufferAttribute(t,n),0===r.x&&0===r.y&&0===r.z?r.setX(1):r.normalize(),t.setXYZ(n,r.x,r.y,r.z);return v.attributesNormalized.set(e,t),t}(p)));var m=null;for(var E in s.attributes)if("morph"!==E.substr(0,5)){var g=s.attributes[E];E=h[E]||E.toUpperCase();if(/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(E)||(E="_"+E),v.attributes.has(y(g)))l[E]=v.attributes.get(y(g));else{m=null;var b=g.array;"JOINTS_0"!==E||b instanceof Uint16Array||b instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),m=new THREE.BufferAttribute(new Uint16Array(b),g.itemSize,g.normalized));var T=S(m||g,s);null!==T&&(l[E]=T,v.attributes.set(y(g),T))}}if(void 0!==p&&s.setAttribute("normal",p),0===Object.keys(l).length)return null;if(void 0!==e.morphTargetInfluences&&e.morphTargetInfluences.length>0){var R=[],_=[],A={};if(void 0!==e.morphTargetDictionary)for(var I in e.morphTargetDictionary)A[e.morphTargetDictionary[I]]=I;for(n=0;n<e.morphTargetInfluences.length;++n){var L={},x=!1;for(var E in s.morphAttributes)if("position"===E||"normal"===E){g=s.morphAttributes[E][n];var N=E.toUpperCase(),H=s.attributes[E];if(v.attributes.has(y(g)))L[N]=v.attributes.get(y(g));else{var O=g.clone();if(!s.morphTargetsRelative)for(var F=0,D=g.count;F<D;F++)O.setXYZ(F,g.getX(F)-H.getX(F),g.getY(F)-H.getY(F),g.getZ(F)-H.getZ(F));L[N]=S(O,s),v.attributes.set(y(H),L[N])}}else x||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),x=!0);d.push(L),R.push(e.morphTargetInfluences[n]),void 0!==e.morphTargetDictionary&&_.push(A[n])}u.weights=R,_.length>0&&(u.extras={},u.extras.targetNames=_)}var C=Array.isArray(e.material);if(C&&0===s.groups.length)return null;for(var B=C?e.material:[e.material],j=C?s.groups:[{materialIndex:0,start:void 0,count:void 0}],k=(n=0,j.length);n<k;n++){var G={mode:i,attributes:l};if(w(s,G),d.length>0&&(G.targets=d),null!==s.index){var P=y(s.index);void 0===j[n].start&&void 0===j[n].count||(P+=":"+j[n].start+":"+j[n].count),v.attributes.has(P)?G.indices=v.attributes.get(P):(G.indices=S(s.index,s,j[n].start,j[n].count),v.attributes.set(P,G.indices)),null===G.indices&&delete G.indices}var U=M(B[j[n].materialIndex]);null!==U&&(G.material=U),f.push(G)}u.primitives=f,c.meshes||(c.meshes=[]),c.meshes.push(u);var z=c.meshes.length-1;return v.meshes.set(o,z),z}function H(e,t){c.animations||(c.animations=[]);for(var r=(e=THREE.GLTFExporter.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,n=[],a=[],i=0;i<r.length;++i){var s=r[i],u=THREE.PropertyBinding.parseTrackName(s.name),l=THREE.PropertyBinding.findNode(t,u.nodeName),f=o[u.propertyName];if("bones"===u.objectName&&(l=!0===l.isSkinnedMesh?l.skeleton.getBoneByName(u.objectIndex):void 0),!l||!f)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',s.name),null;var d,p=s.values.length/s.times.length;f===o.morphTargetInfluences&&(p/=l.morphTargetInfluences.length),!0===s.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(d="CUBICSPLINE",p/=3):d=s.getInterpolation()===THREE.InterpolateDiscrete?"STEP":"LINEAR",a.push({input:S(new THREE.BufferAttribute(s.times,1)),output:S(new THREE.BufferAttribute(s.values,p)),interpolation:d}),n.push({sampler:a.length-1,target:{node:h.get(l),path:f}})}return c.animations.push({name:e.name||"clip_"+c.animations.length,samplers:a,channels:n}),c.animations.length-1}function O(e){var t=c.nodes[h.get(e)],r=e.skeleton;if(void 0===r)return null;var n=e.skeleton.bones[0];if(void 0===n)return null;for(var a=[],o=new Float32Array(16*r.bones.length),i=new THREE.Matrix4,s=0;s<r.bones.length;++s)a.push(h.get(r.bones[s])),i.copy(r.boneInverses[s]),i.multiply(e.bindMatrix).toArray(o,16*s);return void 0===c.skins&&(c.skins=[]),c.skins.push({inverseBindMatrices:S(new THREE.BufferAttribute(o,16)),joints:a,skeleton:h.get(n)}),t.skin=c.skins.length-1}function F(e){var t={};e.name&&(t.name=e.name),t.color=e.color.toArray(),t.intensity=e.intensity,e.isDirectionalLight?t.type="directional":e.isPointLight?(t.type="point",e.distance>0&&(t.range=e.distance)):e.isSpotLight&&(t.type="spot",e.distance>0&&(t.range=e.distance),t.spot={},t.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,t.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var r=c.extensions.KHR_lights_punctual.lights;return r.push(t),r.length-1}function D(e){c.nodes||(c.nodes=[]);var t={};if(i.trs){var r=e.quaternion.toArray(),a=e.position.toArray(),o=e.scale.toArray();b(r,[0,0,0,1])||(t.rotation=r),b(a,[0,0,0])||(t.translation=a),b(o,[1,1,1])||(t.scale=o)}else e.matrixAutoUpdate&&e.updateMatrix(),!1===b(e.matrix.elements,n)&&(t.matrix=e.matrix.elements);if(""!==e.name&&(t.name=String(e.name)),w(e,t),e.isMesh||e.isLine||e.isPoints){var s=N(e);null!==s&&(t.mesh=s)}else if(e.isCamera)t.camera=function(e){c.cameras||(c.cameras=[]);var t=e.isOrthographicCamera,r={type:t?"orthographic":"perspective"};return t?r.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:r.perspective={aspectRatio:e.aspect,yfov:THREE.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(r.name=e.type),c.cameras.push(r),c.cameras.length-1}(e);else if(e.isDirectionalLight||e.isPointLight||e.isSpotLight)m.KHR_lights_punctual||(c.extensions=c.extensions||{},c.extensions.KHR_lights_punctual={lights:[]},m.KHR_lights_punctual=!0),t.extensions=t.extensions||{},t.extensions.KHR_lights_punctual={light:F(e)};else if(e.isLight)return console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e),null;if(e.isSkinnedMesh&&p.push(e),e.children.length>0){for(var u=[],l=0,f=e.children.length;l<f;l++){var d=e.children[l];if(d.visible||!1===i.onlyVisible){var v=D(d);null!==v&&u.push(v)}}u.length>0&&(t.children=u)}c.nodes.push(t);var E=c.nodes.length-1;return h.set(e,E),E}function C(e){c.scenes||(c.scenes=[],c.scene=0);var t={};""!==e.name&&(t.name=e.name),c.scenes.push(t);for(var r=[],n=0,a=e.children.length;n<a;n++){var o=e.children[n];if(o.visible||!1===i.onlyVisible){var s=D(o);null!==s&&r.push(s)}}r.length>0&&(t.nodes=r),w(e,t)}!function(e){e=e instanceof Array?e:[e];for(var t=[],r=0;r<e.length;r++)e[r]instanceof THREE.Scene?C(e[r]):t.push(e[r]);for(t.length>0&&function(e){var t=new THREE.Scene;t.name="AuxScene";for(var r=0;r<e.length;r++)t.children.push(e[r]);C(t)}(t),r=0;r<p.length;++r)O(p[r]);for(r=0;r<i.animations.length;++r)H(i.animations[r],e[0])}(e),Promise.all(d).then(function(){var e=new Blob(f,{type:"application/octet-stream"}),r=Object.keys(m);if(r.length>0&&(c.extensionsUsed=r),c.buffers&&c.buffers.length>0&&(c.buffers[0].byteLength=e.size),!0===i.binary){(n=new window.FileReader).readAsArrayBuffer(e),n.onloadend=function(){var e=R(n.result),r=new DataView(new ArrayBuffer(8));r.setUint32(0,e.byteLength,!0),r.setUint32(4,5130562,!0);var a=R(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var a=e.charCodeAt(r);t[r]=a>255?32:a}return t.buffer}(JSON.stringify(c)),32),o=new DataView(new ArrayBuffer(8));o.setUint32(0,a.byteLength,!0),o.setUint32(4,1313821514,!0);var i=new ArrayBuffer(12),s=new DataView(i);s.setUint32(0,1179937895,!0),s.setUint32(4,2,!0);var u=12+o.byteLength+a.byteLength+r.byteLength+e.byteLength;s.setUint32(8,u,!0);var l=new Blob([i,o,a,r,e],{type:"application/octet-stream"}),f=new window.FileReader;f.readAsArrayBuffer(l),f.onloadend=function(){t(f.result)}}}else{var n;if(c.buffers&&c.buffers.length>0)(n=new window.FileReader).readAsDataURL(e),n.onloadend=function(){var e=n.result;c.buffers[0].uri=e,t(c)};else t(c)}})}},THREE.GLTFExporter.Utils={insertKeyframe:function(e,t){var r,n=e.getValueSize(),a=new e.TimeBufferType(e.times.length+1),o=new e.ValueBufferType(e.values.length+n),i=e.createInterpolant(new e.ValueBufferType(n));if(0===e.times.length){a[0]=t;for(var s=0;s<n;s++)o[s]=0;r=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<.001)return 0;a[0]=t,a.set(e.times,1),o.set(i.evaluate(t),0),o.set(e.values,n),r=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<.001)return e.times.length-1;a[a.length-1]=t,a.set(e.times,0),o.set(e.values,0),o.set(i.evaluate(t),e.values.length),r=a.length-1}else for(s=0;s<e.times.length;s++){if(Math.abs(e.times[s]-t)<.001)return s;if(e.times[s]<t&&e.times[s+1]>t){a.set(e.times.slice(0,s+1),0),a[s+1]=t,a.set(e.times.slice(s+1),s+2),o.set(e.values.slice(0,(s+1)*n),0),o.set(i.evaluate(t),(s+1)*n),o.set(e.values.slice((s+1)*n),(s+2)*n),r=s+1;break}}return e.times=a,e.values=o,r},mergeMorphTargetTracks:function(e,t){for(var r=[],n={},a=e.tracks,o=0;o<a.length;++o){var i=a[o],s=THREE.PropertyBinding.parseTrackName(i.name),u=THREE.PropertyBinding.findNode(t,s.nodeName);if("morphTargetInfluences"===s.propertyName&&void 0!==s.propertyIndex){if(i.createInterpolant!==i.InterpolantFactoryMethodDiscrete&&i.createInterpolant!==i.InterpolantFactoryMethodLinear){if(i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(i=i.clone()).setInterpolation(THREE.InterpolateLinear)}var c,l=u.morphTargetInfluences.length,f=u.morphTargetDictionary[s.propertyIndex];if(void 0===f)throw new Error("THREE.GLTFExporter: Morph target name not found: "+s.propertyIndex);if(void 0!==n[u.uuid]){var d=i.createInterpolant(new i.ValueBufferType(1));c=n[u.uuid];for(m=0;m<c.times.length;m++)c.values[m*l+f]=d.evaluate(c.times[m]);for(m=0;m<i.times.length;m++){var h=this.insertKeyframe(c,i.times[m]);c.values[h*l+f]=i.values[m]}}else{for(var p=new((c=i.clone()).ValueBufferType)(l*c.times.length),m=0;m<c.times.length;m++)p[m*l+f]=c.values[m];c.name=(s.nodeName||"")+".morphTargetInfluences",c.values=p,n[u.uuid]=c,r.push(c)}}else r.push(i)}return e.tracks=r,e}}},function(e,t,r){(function(t){var r;e.exports=function e(t,n,a){function o(s,u){if(!n[s]){if(!t[s]){if(!u&&"function"==typeof r&&r)return r(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return o(r||e)},l,l.exports,e,t,n,a)}return n[s].exports}for(var i="function"==typeof r&&r,s=0;s<a.length;s++)o(a[s]);return o}({1:[function(e,r,n){(function(e){"use strict";var t,n,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var o=0,i=new a(l),s=e.document.createTextNode("");i.observe(s,{characterData:!0}),t=function(){s.data=o=++o%2}}else if(e.setImmediate||void 0===e.MessageChannel)t="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){l(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(l,0)};else{var u=new e.MessageChannel;u.port1.onmessage=l,t=function(){u.port2.postMessage(0)}}var c=[];function l(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}r.exports=function(e){1!==c.push(e)||n||t()}}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,r){"use strict";var n=e(1);function a(){}var o={},i=["REJECTED"],s=["FULFILLED"],u=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,e!==a&&h(this,e)}function l(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(e,t,r){n(function(){var n;try{n=t(r)}catch(t){return o.reject(e,t)}n===e?o.reject(e,new TypeError("Cannot resolve promise with itself")):o.resolve(e,n)})}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var r=!1;function n(t){r||(r=!0,o.reject(e,t))}function a(t){r||(r=!0,o.resolve(e,t))}var i=p(function(){t(a,n)});"error"===i.status&&n(i.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}t.exports=c,c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===i)return this;var r=new this.constructor(a);return this.state!==u?f(r,this.state===s?e:t,this.outcome):this.queue.push(new l(r,e,t)),r},l.prototype.callFulfilled=function(e){o.resolve(this.promise,e)},l.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},l.prototype.callRejected=function(e){o.reject(this.promise,e)},l.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},o.resolve=function(e,t){var r=p(d,t);if("error"===r.status)return o.reject(e,r.value);var n=r.value;if(n)h(e,n);else{e.state=s,e.outcome=t;for(var a=-1,i=e.queue.length;++a<i;)e.queue[a].callFulfilled(t)}return e},o.reject=function(e,t){e.state=i,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:o.resolve(new this(a),e)},c.reject=function(e){var t=new this(a);return o.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=new Array(r),s=0,u=-1,c=new this(a);++u<r;)l(e[u],u);return c;function l(e,a){t.resolve(e).then(function(e){i[a]=e,++s!==r||n||(n=!0,o.resolve(c,i))},function(e){n||(n=!0,o.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i,s=-1,u=new this(a);++s<r;)i=e[s],t.resolve(i).then(function(e){n||(n=!0,o.resolve(u,e))},function(e){n||(n=!0,o.reject(u,e))});return u}},{1:1}],3:[function(e,r,n){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,r){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function o(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(a){if("TypeError"!==a.name)throw a;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)r.append(e[n]);return r.getBlob(t.type)}}"undefined"==typeof Promise&&e(3);var i=Promise;function s(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function u(e,t,r){"function"==typeof t&&e.then(t),"function"==typeof r&&e.catch(r)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function l(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var f="local-forage-detect-blob-support",d=void 0,h={},p=Object.prototype.toString,m="readonly",v="readwrite";function E(e){return"boolean"==typeof d?i.resolve(d):function(e){return new i(function(t){var r=e.transaction(f,v),n=o([""]);r.objectStore(f).put(n,"key"),r.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},r.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);t(r||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}(e).then(function(e){return d=e})}function g(e){var t=h[e.name],r={};r.promise=new i(function(e,t){r.resolve=e,r.reject=t}),t.deferredOperations.push(r),t.dbReady?t.dbReady=t.dbReady.then(function(){return r.promise}):t.dbReady=r.promise}function y(e){var t=h[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function b(e,t){var r=h[e.name].deferredOperations.pop();if(r)return r.reject(t),r.promise}function T(e,t){return new i(function(r,n){if(h[e.name]=h[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!t)return r(e.db);g(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=a.open.apply(a,o);t&&(i.onupgradeneeded=function(t){var r=i.result;try{r.createObjectStore(e.storeName),t.oldVersion<=1&&r.createObjectStore(f)}catch(r){if("ConstraintError"!==r.name)throw r;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),n(i.error)},i.onsuccess=function(){r(i.result),y(e)}})}function R(e){return T(e,!1)}function w(e){return T(e,!0)}function _(e,t){if(!e.db)return!0;var r=!e.db.objectStoreNames.contains(e.storeName),n=e.version<e.db.version,a=e.version>e.db.version;if(n&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||r){if(r){var o=e.db.version+1;o>e.version&&(e.version=o)}return!0}return!1}function A(e){return o([function(e){for(var t=e.length,r=new ArrayBuffer(t),n=new Uint8Array(r),a=0;a<t;a++)n[a]=e.charCodeAt(a);return r}(atob(e.data))],{type:e.type})}function S(e){return e&&e.__local_forage_encoded_blob}function I(e){var t=this,r=t._initReady().then(function(){var e=h[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return u(r,e,e),r}function L(e,t,r,n){void 0===n&&(n=1);try{var a=e.db.transaction(e.storeName,t);r(null,a)}catch(a){if(n>0&&(!e.db||"InvalidStateError"===a.name||"NotFoundError"===a.name))return i.resolve().then(function(){if(!e.db||"NotFoundError"===a.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),w(e)}).then(function(){return function(e){g(e);for(var t=h[e.name],r=t.forages,n=0;n<r.length;n++){var a=r[n];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,R(e).then(function(t){return e.db=t,_(e)?w(e):t}).then(function(n){e.db=t.db=n;for(var a=0;a<r.length;a++)r[a]._dbInfo.db=n}).catch(function(t){throw b(e,t),t})}(e).then(function(){L(e,t,r,n-1)})}).catch(r);r(a)}}var x={_driver:"asyncStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]=e[n];var a=h[r.name];a||(a={forages:[],db:null,dbReady:null,deferredOperations:[]},h[r.name]=a),a.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=I);var o=[];function s(){return i.resolve()}for(var u=0;u<a.forages.length;u++){var c=a.forages[u];c!==t&&o.push(c._initReady().catch(s))}var l=a.forages.slice(0);return i.all(o).then(function(){return r.db=a.db,R(r)}).then(function(e){return r.db=e,_(r,t._defaultConfig.version)?w(r):e}).then(function(e){r.db=a.db=e,t._dbInfo=r;for(var n=0;n<l.length;n++){var o=l[n];o!==t&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})},_support:function(){try{if(!a||!a.open)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=new i(function(t,n){r.ready().then(function(){L(r._dbInfo,m,function(a,o){if(a)return n(a);try{var i=o.objectStore(r._dbInfo.storeName).openCursor(),s=1;i.onsuccess=function(){var r=i.result;if(r){var n=r.value;S(n)&&(n=A(n));var a=e(n,r.key,s++);void 0!==a?t(a):r.continue()}else t()},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return s(n,t),n},getItem:function(e,t){var r=this;e=c(e);var n=new i(function(t,n){r.ready().then(function(){L(r._dbInfo,m,function(a,o){if(a)return n(a);try{var i=o.objectStore(r._dbInfo.storeName).get(e);i.onsuccess=function(){var e=i.result;void 0===e&&(e=null),S(e)&&(e=A(e)),t(e)},i.onerror=function(){n(i.error)}}catch(e){n(e)}})}).catch(n)});return s(n,t),n},setItem:function(e,t,r){var n=this;e=c(e);var a=new i(function(r,a){var o;n.ready().then(function(){return o=n._dbInfo,"[object Blob]"===p.call(t)?E(o.db).then(function(e){return e?t:(r=t,new i(function(e,t){var n=new FileReader;n.onerror=t,n.onloadend=function(t){var n=btoa(t.target.result||"");e({__local_forage_encoded_blob:!0,data:n,type:r.type})},n.readAsBinaryString(r)}));var r}):t}).then(function(t){L(n._dbInfo,v,function(o,i){if(o)return a(o);try{var s=i.objectStore(n._dbInfo.storeName);null===t&&(t=void 0);var u=s.put(t,e);i.oncomplete=function(){void 0===t&&(t=null),r(t)},i.onabort=i.onerror=function(){var e=u.error?u.error:u.transaction.error;a(e)}}catch(e){a(e)}})}).catch(a)});return s(a,r),a},removeItem:function(e,t){var r=this;e=c(e);var n=new i(function(t,n){r.ready().then(function(){L(r._dbInfo,v,function(a,o){if(a)return n(a);try{var i=o.objectStore(r._dbInfo.storeName).delete(e);o.oncomplete=function(){t()},o.onerror=function(){n(i.error)},o.onabort=function(){var e=i.error?i.error:i.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return s(n,t),n},clear:function(e){var t=this,r=new i(function(e,r){t.ready().then(function(){L(t._dbInfo,v,function(n,a){if(n)return r(n);try{var o=a.objectStore(t._dbInfo.storeName).clear();a.oncomplete=function(){e()},a.onabort=a.onerror=function(){var e=o.error?o.error:o.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return s(r,e),r},length:function(e){var t=this,r=new i(function(e,r){t.ready().then(function(){L(t._dbInfo,m,function(n,a){if(n)return r(n);try{var o=a.objectStore(t._dbInfo.storeName).count();o.onsuccess=function(){e(o.result)},o.onerror=function(){r(o.error)}}catch(e){r(e)}})}).catch(r)});return s(r,e),r},key:function(e,t){var r=this,n=new i(function(t,n){e<0?t(null):r.ready().then(function(){L(r._dbInfo,m,function(a,o){if(a)return n(a);try{var i=o.objectStore(r._dbInfo.storeName),s=!1,u=i.openKeyCursor();u.onsuccess=function(){var r=u.result;r?0===e?t(r.key):s?t(r.key):(s=!0,r.advance(e)):t(null)},u.onerror=function(){n(u.error)}}catch(e){n(e)}})}).catch(n)});return s(n,t),n},keys:function(e){var t=this,r=new i(function(e,r){t.ready().then(function(){L(t._dbInfo,m,function(n,a){if(n)return r(n);try{var o=a.objectStore(t._dbInfo.storeName).openKeyCursor(),i=[];o.onsuccess=function(){var t=o.result;t?(i.push(t.key),t.continue()):e(i)},o.onerror=function(){r(o.error)}}catch(e){r(e)}})}).catch(r)});return s(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments);var r,n=this.config();if((e="function"!=typeof e&&e||{}).name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName),e.name){var o=e.name===n.name&&this._dbInfo.db?i.resolve(this._dbInfo.db):R(e).then(function(t){var r=h[e.name],n=r.forages;r.db=t;for(var a=0;a<n.length;a++)n[a]._dbInfo.db=t;return t});r=e.storeName?o.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var r=t.version+1;g(e);var n=h[e.name],o=n.forages;t.close();for(var s=0;s<o.length;s++){var u=o[s];u._dbInfo.db=null,u._dbInfo.version=r}return new i(function(t,n){var o=a.open(e.name,r);o.onerror=function(e){o.result.close(),n(e)},o.onupgradeneeded=function(){o.result.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<o.length;t++){var r=o[t];r._dbInfo.db=e,y(r._dbInfo)}}).catch(function(t){throw(b(e,t)||i.resolve()).catch(function(){}),t})}}):o.then(function(t){g(e);var r=h[e.name],n=r.forages;t.close();for(var o=0;o<n.length;o++)n[o]._dbInfo.db=null;return new i(function(t,r){var n=a.deleteDatabase(e.name);n.onerror=n.onblocked=function(e){var t=n.result;t&&t.close(),r(e)},n.onsuccess=function(){var e=n.result;e&&e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<n.length;t++)y(n[t]._dbInfo)}).catch(function(t){throw(b(e,t)||i.resolve()).catch(function(){}),t})})}else r=i.reject("Invalid arguments");return s(r,t),r}},M="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",N="~~local_forage_type~",H=/^~~local_forage_type~([^~]+)~/,O="__lfsc__:",F=O.length,D="arbf",C="blob",B="si08",j="ui08",k="uic8",G="si16",P="si32",U="ur16",z="ui32",V="fl32",K="fl64",W=F+D.length,q=Object.prototype.toString;function Y(e){var t,r,n,a,o,i=.75*e.length,s=e.length,u=0;"="===e[e.length-1]&&(i--,"="===e[e.length-2]&&i--);var c=new ArrayBuffer(i),l=new Uint8Array(c);for(t=0;t<s;t+=4)r=M.indexOf(e[t]),n=M.indexOf(e[t+1]),a=M.indexOf(e[t+2]),o=M.indexOf(e[t+3]),l[u++]=r<<2|n>>4,l[u++]=(15&n)<<4|a>>2,l[u++]=(3&a)<<6|63&o;return c}function X(e){var t,r=new Uint8Array(e),n="";for(t=0;t<r.length;t+=3)n+=M[r[t]>>2],n+=M[(3&r[t])<<4|r[t+1]>>4],n+=M[(15&r[t+1])<<2|r[t+2]>>6],n+=M[63&r[t+2]];return r.length%3==2?n=n.substring(0,n.length-1)+"=":r.length%3==1&&(n=n.substring(0,n.length-2)+"=="),n}var J={serialize:function(e,t){var r="";if(e&&(r=q.call(e)),e&&("[object ArrayBuffer]"===r||e.buffer&&"[object ArrayBuffer]"===q.call(e.buffer))){var n,a=O;e instanceof ArrayBuffer?(n=e,a+=D):(n=e.buffer,"[object Int8Array]"===r?a+=B:"[object Uint8Array]"===r?a+=j:"[object Uint8ClampedArray]"===r?a+=k:"[object Int16Array]"===r?a+=G:"[object Uint16Array]"===r?a+=U:"[object Int32Array]"===r?a+=P:"[object Uint32Array]"===r?a+=z:"[object Float32Array]"===r?a+=V:"[object Float64Array]"===r?a+=K:t(new Error("Failed to get type for BinaryArray"))),t(a+X(n))}else if("[object Blob]"===r){var o=new FileReader;o.onload=function(){var r=N+e.type+"~"+X(this.result);t(O+C+r)},o.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(r){console.error("Couldn't convert value into a JSON string: ",e),t(null,r)}},deserialize:function(e){if(e.substring(0,F)!==O)return JSON.parse(e);var t,r=e.substring(W),n=e.substring(F,W);if(n===C&&H.test(r)){var a=r.match(H);t=a[1],r=r.substring(a[0].length)}var i=Y(r);switch(n){case D:return i;case C:return o([i],{type:t});case B:return new Int8Array(i);case j:return new Uint8Array(i);case k:return new Uint8ClampedArray(i);case G:return new Int16Array(i);case U:return new Uint16Array(i);case P:return new Int32Array(i);case z:return new Uint32Array(i);case V:return new Float32Array(i);case K:return new Float64Array(i);default:throw new Error("Unkown type: "+n)}},stringToBuffer:Y,bufferToString:X};function Q(e,t,r,n){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,n)}function Z(e,t,r,n,a,o){e.executeSql(r,n,a,function(e,i){i.code===i.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,s){s.rows.length?o(e,i):Q(e,t,function(){e.executeSql(r,n,a,o)},o)},o):o(e,i)},o)}var $={_driver:"webSQLStorage",_initStorage:function(e){var t=this,r={db:null};if(e)for(var n in e)r[n]="string"!=typeof e[n]?e[n].toString():e[n];var a=new i(function(e,n){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(e){return n(e)}r.db.transaction(function(a){Q(a,r,function(){t._dbInfo=r,e()},function(e,t){n(t)})},n)});return r.serializer=J,a},_support:"function"==typeof openDatabase,iterate:function(e,t){var r=this,n=new i(function(t,n){r.ready().then(function(){var a=r._dbInfo;a.db.transaction(function(r){Z(r,a,"SELECT * FROM "+a.storeName,[],function(r,n){for(var o=n.rows,i=o.length,s=0;s<i;s++){var u=o.item(s),c=u.value;if(c&&(c=a.serializer.deserialize(c)),void 0!==(c=e(c,u.key,s+1)))return void t(c)}t()},function(e,t){n(t)})})}).catch(n)});return s(n,t),n},getItem:function(e,t){var r=this;e=c(e);var n=new i(function(t,n){r.ready().then(function(){var a=r._dbInfo;a.db.transaction(function(r){Z(r,a,"SELECT * FROM "+a.storeName+" WHERE key = ? LIMIT 1",[e],function(e,r){var n=r.rows.length?r.rows.item(0).value:null;n&&(n=a.serializer.deserialize(n)),t(n)},function(e,t){n(t)})})}).catch(n)});return s(n,t),n},setItem:function(e,t,r){return function e(t,r,n,a){var o=this;t=c(t);var u=new i(function(i,s){o.ready().then(function(){void 0===r&&(r=null);var u=r,c=o._dbInfo;c.serializer.serialize(r,function(r,l){l?s(l):c.db.transaction(function(e){Z(e,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[t,r],function(){i(u)},function(e,t){s(t)})},function(r){if(r.code===r.QUOTA_ERR){if(a>0)return void i(e.apply(o,[t,u,n,a-1]));s(r)}})})}).catch(s)});return s(u,n),u}.apply(this,[e,t,r,1])},removeItem:function(e,t){var r=this;e=c(e);var n=new i(function(t,n){r.ready().then(function(){var a=r._dbInfo;a.db.transaction(function(r){Z(r,a,"DELETE FROM "+a.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){n(t)})})}).catch(n)});return s(n,t),n},clear:function(e){var t=this,r=new i(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){Z(t,n,"DELETE FROM "+n.storeName,[],function(){e()},function(e,t){r(t)})})}).catch(r)});return s(r,e),r},length:function(e){var t=this,r=new i(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){Z(t,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(t,r){var n=r.rows.item(0).c;e(n)},function(e,t){r(t)})})}).catch(r)});return s(r,e),r},key:function(e,t){var r=this,n=new i(function(t,n){r.ready().then(function(){var a=r._dbInfo;a.db.transaction(function(r){Z(r,a,"SELECT key FROM "+a.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,r){var n=r.rows.length?r.rows.item(0).key:null;t(n)},function(e,t){n(t)})})}).catch(n)});return s(n,t),n},keys:function(e){var t=this,r=new i(function(e,r){t.ready().then(function(){var n=t._dbInfo;n.db.transaction(function(t){Z(t,n,"SELECT key FROM "+n.storeName,[],function(t,r){for(var n=[],a=0;a<r.rows.length;a++)n.push(r.rows.item(a).key);e(n)},function(e,t){r(t)})})}).catch(r)});return s(r,e),r},dropInstance:function(e,t){t=l.apply(this,arguments);var r=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||r.name,e.storeName=e.storeName||r.storeName);var n,a=this;return s(n=e.name?new i(function(t){var n;n=e.name===r.name?a._dbInfo.db:openDatabase(e.name,"","",0),e.storeName?t({db:n,storeNames:[e.storeName]}):t(function(e){return new i(function(t,r){e.transaction(function(n){n.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(r,n){for(var a=[],o=0;o<n.rows.length;o++)a.push(n.rows.item(o).name);t({db:e,storeNames:a})},function(e,t){r(t)})},function(e){r(e)})})}(n))}).then(function(e){return new i(function(t,r){e.db.transaction(function(n){function a(e){return new i(function(t,r){n.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){r(t)})})}for(var o=[],s=0,u=e.storeNames.length;s<u;s++)o.push(a(e.storeNames[s]));i.all(o).then(function(){t()}).catch(function(e){r(e)})},function(e){r(e)})})}):i.reject("Invalid arguments"),t),n}};function ee(e,t){var r=e.name+"/";return e.storeName!==t.storeName&&(r+=e.storeName+"/"),r}function te(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var re={_driver:"localStorageWrapper",_initStorage:function(e){var t={};if(e)for(var r in e)t[r]=e[r];return t.keyPrefix=ee(e,this._defaultConfig),te()?(this._dbInfo=t,t.serializer=J,i.resolve()):i.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(e,t){var r=this,n=r.ready().then(function(){for(var t=r._dbInfo,n=t.keyPrefix,a=n.length,o=localStorage.length,i=1,s=0;s<o;s++){var u=localStorage.key(s);if(0===u.indexOf(n)){var c=localStorage.getItem(u);if(c&&(c=t.serializer.deserialize(c)),void 0!==(c=e(c,u.substring(a),i++)))return c}}});return s(n,t),n},getItem:function(e,t){var r=this;e=c(e);var n=r.ready().then(function(){var t=r._dbInfo,n=localStorage.getItem(t.keyPrefix+e);return n&&(n=t.serializer.deserialize(n)),n});return s(n,t),n},setItem:function(e,t,r){var n=this;e=c(e);var a=n.ready().then(function(){void 0===t&&(t=null);var r=t;return new i(function(a,o){var i=n._dbInfo;i.serializer.serialize(t,function(t,n){if(n)o(n);else try{localStorage.setItem(i.keyPrefix+e,t),a(r)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||o(e),o(e)}})})});return s(a,r),a},removeItem:function(e,t){var r=this;e=c(e);var n=r.ready().then(function(){var t=r._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return s(n,t),n},clear:function(e){var t=this,r=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var n=localStorage.key(r);0===n.indexOf(e)&&localStorage.removeItem(n)}});return s(r,e),r},length:function(e){var t=this.keys().then(function(e){return e.length});return s(t,e),t},key:function(e,t){var r=this,n=r.ready().then(function(){var t,n=r._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(n.keyPrefix.length)),t});return s(n,t),n},keys:function(e){var t=this,r=t.ready().then(function(){for(var e=t._dbInfo,r=localStorage.length,n=[],a=0;a<r;a++){var o=localStorage.key(a);0===o.indexOf(e.keyPrefix)&&n.push(o.substring(e.keyPrefix.length))}return n});return s(r,e),r},dropInstance:function(e,t){if(t=l.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var r=this.config();e.name=e.name||r.name,e.storeName=e.storeName||r.storeName}var n,a=this;return s(n=e.name?new i(function(t){e.storeName?t(ee(e,a._defaultConfig)):t(e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var r=localStorage.key(t);0===r.indexOf(e)&&localStorage.removeItem(r)}}):i.reject("Invalid arguments"),t),n}},ne=function(e,t){for(var r,n,a=e.length,o=0;o<a;){if((r=e[o])===(n=t)||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;o++}return!1},ae=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},oe={},ie={},se={INDEXEDDB:x,WEBSQL:$,LOCALSTORAGE:re},ue=[se.INDEXEDDB._driver,se.WEBSQL._driver,se.LOCALSTORAGE._driver],ce=["dropInstance"],le=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(ce),fe={description:"",driver:ue.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function de(e,t){e[t]=function(){var r=arguments;return e.ready().then(function(){return e[t].apply(e,r)})}}function he(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var r in t)t.hasOwnProperty(r)&&(ae(t[r])?arguments[0][r]=t[r].slice():arguments[0][r]=t[r])}return arguments[0]}var pe=new(function(){function e(t){for(var r in function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),se)if(se.hasOwnProperty(r)){var n=se[r],a=n._driver;this[r]=a,oe[a]||this.defineDriver(n)}this._defaultConfig=he({},fe),this._config=he({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===(void 0===e?"undefined":n(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,r){var n=new i(function(t,r){try{var n=e._driver,a=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void r(a);for(var o=le.concat("_initStorage"),u=0,c=o.length;u<c;u++){var l=o[u];if((!ne(ce,l)||e[l])&&"function"!=typeof e[l])return void r(a)}!function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),r=i.reject(t);return s(r,arguments[arguments.length-1]),r}},r=0,n=ce.length;r<n;r++){var a=ce[r];e[a]||(e[a]=t(a))}}();var f=function(r){oe[n]&&console.info("Redefining LocalForage driver: "+n),oe[n]=e,ie[n]=r,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(f,r):f(!!e._support):f(!0)}catch(e){r(e)}});return u(n,t,r),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var n=oe[e]?i.resolve(oe[e]):i.reject(new Error("Driver not found."));return u(n,t,r),n},e.prototype.getSerializer=function(e){var t=i.resolve(J);return u(t,e),t},e.prototype.ready=function(e){var t=this,r=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return u(r,e,e),r},e.prototype.setDriver=function(e,t,r){var n=this;ae(e)||(e=[e]);var a=this._getSupportedDrivers(e);function o(){n._config.driver=n.driver()}function s(e){return n._extend(e),o(),n._ready=n._initStorage(n._config),n._ready}var c=null!==this._driverSet?this._driverSet.catch(function(){return i.resolve()}):i.resolve();return this._driverSet=c.then(function(){var e=a[0];return n._dbInfo=null,n._ready=null,n.getDriver(e).then(function(e){n._driver=e._driver,o(),n._wrapLibraryMethodsWithReady(),n._initDriver=function(e){return function(){var t=0;return function r(){for(;t<e.length;){var a=e[t];return t++,n._dbInfo=null,n._ready=null,n.getDriver(a).then(s).catch(r)}o();var u=new Error("No available storage method found.");return n._driverSet=i.reject(u),n._driverSet}()}}(a)})}).catch(function(){o();var e=new Error("No available storage method found.");return n._driverSet=i.reject(e),n._driverSet}),u(this._driverSet,t,r),this._driverSet},e.prototype.supports=function(e){return!!ie[e]},e.prototype._extend=function(e){he(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],r=0,n=e.length;r<n;r++){var a=e[r];this.supports(a)&&t.push(a)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=le.length;e<t;e++)de(this,le[e])},e.prototype.createInstance=function(t){return new e(t)},e}());t.exports=pe},{3:3}]},{},[4])(4)}).call(this,r(4))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r}])});